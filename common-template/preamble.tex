%% ==========================================================================
%% preamble.tex - Core LaTeX packages for academic papers
%% ==========================================================================
%% Include with: \input{preamble.tex}
%% For TikZ figures, also include: \input{tikz/setup.tex}
%% ==========================================================================

%% ------------------------------------------
%% Math
%% ------------------------------------------
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{amsthm}             % theorem environments (proof, etc.)
\usepackage{mathtools}          % extends amsmath (dcases, coloneqq, etc.)
\usepackage{mathrsfs}           % \mathscr for script fonts
\usepackage{bm}                 % bold math symbols

%% ------------------------------------------
%% Graphics and color
%% ------------------------------------------
\usepackage{graphicx}
\usepackage{xcolor}             % color support

%% ------------------------------------------
%% Typography
%% ------------------------------------------
\usepackage{microtype}          % better typography (kerning, spacing)
\usepackage[english]{babel}     % hyphenation patterns
\usepackage{setspace}           % line spacing (\onehalfspacing, \doublespacing)

%% ------------------------------------------
%% Tables
%% ------------------------------------------
\usepackage{booktabs}           % professional tables (\toprule, \midrule, \bottomrule)
\usepackage{multirow}           % multi-row cells in tables
\usepackage{array}              % extended column definitions
% \usepackage{threeparttable}   % tables with footnotes
% \usepackage{longtable}        % multi-page tables
% \usepackage{diagbox}          % diagonal boxes in table headers

%% ------------------------------------------
%% Figures
%% ------------------------------------------
\usepackage{caption}
\captionsetup{
  justification=raggedright,
  singlelinecheck=false
}
\usepackage{subcaption}         % subfigures (\begin{subfigure})

%% ------------------------------------------
%% Algorithms (choose one pair, comment out the other)
%% ------------------------------------------
\usepackage{algorithm}
\usepackage{algpseudocode}      % algorithmicx style
% \usepackage[ruled,vlined]{algorithm2e} % alternative style

%% ------------------------------------------
%% Lists
%% ------------------------------------------
\usepackage{enumitem}           % customizable lists (label=, nosep, etc.)

%% ------------------------------------------
%% Document structure
%% ------------------------------------------
\usepackage{subfiles}           % multi-file documents
\usepackage[toc,page,title,titletoc]{appendix}

%% ------------------------------------------
%% Authors
%% ------------------------------------------
\usepackage{authblk}            % multiple authors with affiliations

%% ------------------------------------------
%% Hyperlinks (load near end - redefines many commands)
%% ------------------------------------------
\PassOptionsToPackage{hyphens}{url}  % allow URL line breaks at hyphens
\definecolor{linkblue}{rgb}{0.0, 0.0, 0.55}
\definecolor{citeblue}{rgb}{0.0, 0.0, 0.55}
\definecolor{urlblue}{rgb}{0.0, 0.25, 0.55}
\usepackage{hyperref}
\hypersetup{
  colorlinks=true,
  linkcolor=linkblue,
  citecolor=citeblue,
  urlcolor=urlblue,
  plainpages=false,
  hypertexnames=false
}
\usepackage{bookmark}           % better PDF bookmarks (must follow hyperref)

%% ------------------------------------------
%% Bibliography
%% ------------------------------------------
\usepackage{natbib}

%% ==========================================================================
%% Theorem environments
%% ==========================================================================
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{assumption}[theorem]{Assumption}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

%% ==========================================================================
%% Numbering
%% ==========================================================================
\numberwithin{equation}{section}
\numberwithin{table}{section}
\numberwithin{figure}{section}

%% ==========================================================================
%% Common math macros
%% ==========================================================================

%%% Number sets
\newcommand{\R}{\mathbb{R}}     % real numbers
\newcommand{\Z}{\mathbb{Z}}     % integers
\newcommand{\N}{\mathbb{N}}     % natural numbers
\newcommand{\Q}{\mathbb{Q}}     % rationals
\newcommand{\C}{\mathbb{C}}     % complex numbers

%%% Probability and expectation
\newcommand{\E}{\mathbb{E}}     % expectation
\newcommand{\Var}{\mathrm{Var}} % variance
\newcommand{\Cov}{\mathrm{Cov}} % covariance
\newcommand{\pr}{\mathbb{P}}    % probability
\newcommand{\ind}[1]{\mathbf{1}_{\{#1\}}} % indicator function

%%% Common operators
\newcommand{\argmin}{\operatornamewithlimits{argmin}}
\newcommand{\argmax}{\operatornamewithlimits{argmax}}

%%% Brackets and norms
\newcommand{\abs}[1]{\left|#1\right|}           % absolute value
\newcommand{\norm}[1]{\left\|#1\right\|}        % norm
\newcommand{\inner}[2]{\langle#1,#2\rangle}     % inner product
\newcommand{\floor}[1]{\lfloor#1\rfloor}        % floor
\newcommand{\ceil}[1]{\lceil#1\rceil}           % ceiling
\newcommand{\pos}[1]{\left[#1\right]^+}         % positive part

%%% Convergence
\newcommand{\dto}{\Rightarrow}                  % convergence in distribution
\newcommand{\pto}{\xrightarrow{p}}              % convergence in probability
\newcommand{\asto}{\xrightarrow{a.s.}}          % almost sure convergence

%% ==========================================================================
%% Track changes (must resolve before final version)
%% ==========================================================================
\usepackage[normalem]{ulem}
\definecolor{tc-del}{RGB}{180, 40, 40}    % muted red
\definecolor{tc-ins}{RGB}{0, 90, 160}     % steel blue
\definecolor{tc-cmt}{RGB}{0, 120, 100}    % teal
\newcommand{\replace}[2]{\textcolor{tc-del}{\sout{#1}} \textcolor{tc-ins}{{#2}}}
\newcommand{\delete}[1]{\textcolor{tc-del}{\sout{#1}}}
\newcommand{\ins}[1]{\textcolor{tc-ins}{{#1}}}
\newcommand{\cmt}[2]{\textcolor{tc-cmt}{({#1}: {#2})}}
